!function(la,ma){function C(c,d,a){this.root=this.currentNode=c;this.nodeType=d;this.filter=a}function na(c,d,a){if(c.nodeName!==d)return!1;for(var b in a)if(c.getAttribute(b)!==a[b])return!1;return!0}function za(c,d){return!J(c)&&c.nodeType===d.nodeType&&c.nodeName===d.nodeName&&c.className===d.className&&(!c.style&&!d.style||c.style.cssText===d.style.cssText)}function J(c){return c.nodeType===v&&!!Aa[c.nodeName]}function r(c){return Qa.test(c.nodeName)}function D(c){var d=c.nodeType;if(d=(d===v||
d===Ba)&&!r(c))a:{c=c.childNodes;for(d=c.length;d--;)if(!r(c[d])){d=!1;break a}d=!0}return d}function P(c){var d=c.nodeType;return!(d!==v&&d!==Ba||r(c)||D(c))}function Q(c){var d=new C(c.ownerDocument.body,V,D,!1);return d.currentNode=c,d}function K(c){return Q(c).nextNode()}function y(c,d,a){do if(na(c,d,a))return c;while(c=c.parentNode);return null}function oa(c){var d,a,b,e,f,g=c.parentNode;return g&&c.nodeType===v?(d=oa(g),d+=(d?">":"")+c.nodeName,(a=c.id)&&(d+="#"+a),(b=c.className.trim())&&
(e=b.split(/\s\s*/),e.sort(),d+=".",d+=e.join(".")),(f=c.dir)&&(d+="[dir="+f+"]")):d=g?oa(g):"",d}function R(c){return c.nodeType===v?c.childNodes.length:c.length||0}function B(c){var d=c.parentNode;return d&&d.removeChild(c),c}function E(c,d){var a=c.parentNode;a&&a.replaceChild(d,c)}function w(c){for(var d=c.ownerDocument.createDocumentFragment(),a=c.childNodes,a=a?a.length:0;a--;)d.appendChild(c.firstChild);return d}function t(c,d,a,b){var e;c=c.createElement(d);if(a instanceof Array&&(b=a,a=null),
a)for(e in a)d=a[e],d!==ma&&c.setAttribute(e,a[e]);if(b)for(a=0,e=b.length;e>a;a+=1)c.appendChild(b[a]);return c}function x(c){var d,a,b=c.ownerDocument,e=c;if("BODY"===c.nodeName&&((a=c.firstChild)&&"BR"!==a.nodeName||(d=pa(b).createDefaultBlock(),a?c.replaceChild(d,a):c.appendChild(d),c=d,d=null)),r(c)){for(a=c.firstChild;qa&&a&&a.nodeType===n&&!a.data;)c.removeChild(a),a=c.firstChild;a||(qa?(d=b.createTextNode(da),pa(b)._didAddZWS()):d=b.createTextNode(""))}else if(ra){for(;c.nodeType!==n&&!J(c);){if(a=
c.firstChild,!a){d=b.createTextNode("");break}c=a}c.nodeType===n?/^ +$/.test(c.data)&&(c.data=""):J(c)&&c.parentNode.insertBefore(b.createTextNode(""),c)}else if(!c.querySelector("BR"))for(d=t(b,"BR");(a=c.lastElementChild)&&!r(a);)c=a;return d&&c.appendChild(d),e}function W(c){var d,a,b,e,f=c.childNodes,g=c.ownerDocument,k=null,u=pa(g)._config;d=0;for(a=f.length;a>d;d+=1)b=f[d],e="BR"===b.nodeName,!e&&r(b)?(k||(k=t(g,u.blockTag,u.blockAttributes)),k.appendChild(b),--d,--a):(e||k)&&(k||(k=t(g,u.blockTag,
u.blockAttributes)),x(k),e?c.replaceChild(k,b):(c.insertBefore(k,b),d+=1,a+=1),k=null),P(b)&&W(b);return k&&c.appendChild(x(k)),c}function F(c,d,a){var b,e,f;b=c.nodeType;if(b===n&&c!==a)return F(c.parentNode,c.splitText(d),a);if(b===v){if("number"==typeof d&&(d=d<c.childNodes.length?c.childNodes[d]:null),c===a)return d;b=c.parentNode;for(e=c.cloneNode(!1);d;)f=d.nextSibling,e.appendChild(d),d=f;return"OL"===c.nodeName&&y(c,"BLOCKQUOTE")&&(e.start=(+c.start||1)+c.childNodes.length-1),x(c),x(e),(f=
c.nextSibling)?b.insertBefore(e,f):b.appendChild(e),F(b,e,a)}return d}function X(c,d){if(c.nodeType===v)for(var a,b,e,f=c.childNodes,g=f.length,k=[];g--;)if(a=f[g],b=g&&f[g-1],g&&r(a)&&za(a,b)&&!Aa[a.nodeName])d.startContainer===a&&(d.startContainer=b,d.startOffset+=R(b)),d.endContainer===a&&(d.endContainer=b,d.endOffset+=R(b)),d.startContainer===c&&(d.startOffset>g?--d.startOffset:d.startOffset===g&&(d.startContainer=b,d.startOffset=R(b))),d.endContainer===c&&(d.endOffset>g?--d.endOffset:d.endOffset===
g&&(d.endContainer=b,d.endOffset=R(b))),B(a),a.nodeType===n?b.appendData(a.data):k.push(w(a));else if(a.nodeType===v){for(e=k.length;e--;)a.appendChild(k.pop());X(a,d)}}function sa(c,d,a){var b,e;for(b=d;1===b.parentNode.childNodes.length;)b=b.parentNode;B(b);e=c.childNodes.length;(b=c.lastChild)&&"BR"===b.nodeName&&(c.removeChild(b),--e);e={startContainer:c,startOffset:e,endContainer:c,endOffset:e};c.appendChild(w(d));X(c,e);a.setStart(e.startContainer,e.startOffset);a.collapse(!0);Y&&(b=c.lastChild)&&
"BR"===b.nodeName&&c.removeChild(b)}function U(c){var d,a=c.previousSibling,b=c.firstChild;d=c.ownerDocument;var e="LI"===c.nodeName;if(!e||b&&/^[OU]L$/.test(b.nodeName))if(a&&za(a,c)){if(!P(a)){if(!e)return;d=t(d,"DIV");d.appendChild(w(a));a.appendChild(d)}B(c);d=!P(c);a.appendChild(w(c));d&&W(a);b&&U(b)}else e&&(a=t(d,"DIV"),c.insertBefore(a,b),x(a))}function pa(c){for(var d,a=Z.length;a--;)if(d=Z[a],d._doc===c)return d;return null}function ta(c,d){var a,b;c||(c={});for(a in d)b=d[a],c[a]=b&&b.constructor===
Object?ta(c[a],b):b;return c}function ea(c,d){var a,b=c.defaultView,e=c.body;this._win=b;this._doc=c;this._body=e;this._events={};this._lastSelection=null;Ca&&this.addEventListener("beforedeactivate",this.getSelection);this._hasZWS=!1;this._lastFocusNode=this._lastAnchorNode=null;this._path="";this.addEventListener("keyup",this._updatePathOnEvent);this.addEventListener("mouseup",this._updatePathOnEvent);b.addEventListener("focus",this,!1);b.addEventListener("blur",this,!1);this._undoIndex=-1;this._undoStack=
[];this._undoStackLength=0;this._ignoreChange=this._isInUndoState=!1;aa?(a=new MutationObserver(this._docWasChanged.bind(this)),a.observe(e,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),this._mutation=a):this.addEventListener("keyup",this._keyUpDetectChange);this._awaitingPaste=!1;this.addEventListener(ba?"beforecut":"cut",Ra);this.addEventListener(ba?"beforepaste":"paste",Sa);this.addEventListener(Y?"keypress":"keydown",Ta);this._keyHandlers=Object.create(p);this.setConfig(d);ba&&(b.Text.prototype.splitText=
function(a){var b=this.ownerDocument.createTextNode(this.data.slice(a)),c=this.nextSibling,e=this.parentNode,d=this.length-a;return c?e.insertBefore(b,c):e.appendChild(b),d&&this.deleteData(a,d),b});e.setAttribute("contenteditable","true");try{c.execCommand("enableObjectResizing",!1,"false"),c.execCommand("enableInlineTableEditing",!1,"false")}catch(f){}Z.push(this);this.setHTML("")}function ua(c,d,a){var b;for(d=d.firstChild;d;d=b){if(b=d.nextSibling,r(d)){if(d.nodeType===n||"BR"===d.nodeName||"IMG"===
d.nodeName){a.appendChild(d);continue}}else if(D(d)){a.appendChild(c.createDefaultBlock([ua(c,d,c._doc.createDocumentFragment())]));continue}ua(c,d,a)}return a}var v=1,n=3,Ba=11,V=1,da="\u200b",L=la.defaultView,l=navigator.userAgent,Ua=/iP(?:ad|hone|od)/.test(l),h=/Mac OS X/.test(l),Da=/Gecko\//.test(l),ba=/Trident\/[456]\./.test(l),Y=!!L.opera,M=/WebKit\//.test(l),l=h?"meta-":"ctrl-",ra=ba||Y,qa=ba||M,Ca=ba,aa="undefined"!=typeof MutationObserver,S=/[^ \t\r\n]/,z=Array.prototype.indexOf;Object.create||
(Object.create=function(c){var d=function(){};return d.prototype=c,new d});var va={1:1,2:2,3:4,8:128,9:256,11:1024};C.prototype.nextNode=function(){for(var c,d=this.currentNode,a=this.root,b=this.nodeType,e=this.filter;;){for(c=d.firstChild;!c&&d&&d!==a;)(c=d.nextSibling)||(d=d.parentNode);if(!c)return null;if(va[c.nodeType]&b&&e(c))return this.currentNode=c,c;d=c}};C.prototype.previousNode=function(){for(var c,d=this.currentNode,a=this.root,b=this.nodeType,e=this.filter;;){if(d===a)return null;if(c=
d.previousSibling)for(;d=c.lastChild;)c=d;else c=d.parentNode;if(!c)return null;if(va[c.nodeType]&b&&e(c))return this.currentNode=c,c;d=c}};C.prototype.previousPONode=function(){for(var c,d=this.currentNode,a=this.root,b=this.nodeType,e=this.filter;;){for(c=d.lastChild;!c&&d&&d!==a;)(c=d.previousSibling)||(d=d.parentNode);if(!c)return null;if(va[c.nodeType]&b&&e(c))return this.currentNode=c,c;d=c}};var Qa=/^(?:#text|A(?:BBR|CRONYM)?|B(?:R|D[IO])?|C(?:ITE|ODE)|D(?:ATA|EL|FN)|EM|FONT|HR|I(?:MG|NPUT|NS)?|KBD|Q|R(?:P|T|UBY)|S(?:AMP|MALL|PAN|TR(?:IKE|ONG)|U[BP])?|U|VAR|WBR)$/,
Aa={BR:1,IMG:1,INPUT:1},Ea=function(c,d){for(var a=c.childNodes;d&&c.nodeType===v;)c=a[d-1],a=c.childNodes,d=a.length;return c},Fa=function(c,d){if(c.nodeType===v){var a=c.childNodes;if(d<a.length)c=a[d];else{for(;c&&!c.nextSibling;)c=c.parentNode;c&&(c=c.nextSibling)}}return c},N=function(c,d){var a,b,e,f=c.startContainer,g=c.startOffset,k=c.endContainer,u=c.endOffset;f.nodeType===n?(a=f.parentNode,b=a.childNodes,g===f.length?(g=z.call(b,f)+1,c.collapsed&&(k=a,u=g)):(g&&(e=f.splitText(g),k===f?(u-=
g,k=e):k===a&&(u+=1),f=e),g=z.call(b,f)),f=a):b=f.childNodes;a=b.length;g===a?f.appendChild(d):f.insertBefore(d,b[g]);f===k&&(u+=b.length-a);c.setStart(f,g);c.setEnd(k,u)},Ga=function(c,d){var a=c.startContainer,b=c.startOffset,e=c.endContainer,f=c.endOffset;d||(d=c.commonAncestorContainer);d.nodeType===n&&(d=d.parentNode);for(var g,k,f=F(e,f,d),u=F(a,b,d),h=d.ownerDocument.createDocumentFragment();u!==f;)e=u.nextSibling,h.appendChild(u),u=e;return a=d,b=f?z.call(d.childNodes,f):d.childNodes.length,
k=d.childNodes[b],g=k&&k.previousSibling,g&&g.nodeType===n&&k.nodeType===n&&(a=g,b=g.length,g.appendData(k.data),B(k)),c.setStart(a,b),c.collapse(!0),x(d),h},fa=function(c){ia(c);var d=c.startContainer,a=c.endContainer,b=(r(d)||D(d))&&(r(a)||D(a));Ga(c);O(c);b&&(d=H(c),a=ja(c),d&&a&&d!==a&&sa(d,a,c));d&&x(d);d=c.endContainer.ownerDocument.body;(a=d.firstChild)&&"BR"!==a.nodeName?c.collapse(!1):(x(d),c.selectNodeContents(d.firstChild))},Va=function(c,d){for(var a=!0,b=d.childNodes,e=b.length;e--;)if(!r(b[e])){a=
!1;break}if(c.collapsed||fa(c),O(c),a)N(c,d),c.collapse(!1);else{for(var f,g,k,a=c.startContainer,a=F(a,c.startOffset,y(a.parentNode,"BLOCKQUOTE")||a.ownerDocument.body),e=b=a.previousSibling,u=e.childNodes.length,h=a,A=0,m=a.parentNode;(f=e.lastChild)&&f.nodeType===v;){if("BR"===f.nodeName){--u;break}e=f;u=e.childNodes.length}for(;(f=h.firstChild)&&f.nodeType===v&&"BR"!==f.nodeName;)h=f;for(k=e.childNodes[u]||null;(f=d.firstChild)&&r(f);)e.insertBefore(f,k);for(;(f=d.lastChild)&&r(f);)h.insertBefore(f,
h.firstChild),A+=1;for(f=d;f=K(f);)x(f);if(m.insertBefore(d,a),g=b.nextSibling,f=Q(g).previousNode(),!/\S/.test(f.textContent)){do m=f.parentNode,m.removeChild(f),f=m;while(m&&!m.lastChild&&"BODY"!==m.nodeName)}if(b.parentNode||(b=g.previousSibling),e.parentNode||(e=b||g.parentNode,u=b?b.childNodes.length:0),P(g)&&U(g),g=a.previousSibling,f=D(a)?a:K(a),!/\S/.test(f.textContent)){do m=f.parentNode,m.removeChild(f),f=m;while(m&&!m.lastChild&&"BODY"!==m.nodeName)}a.parentNode||(a=g.nextSibling);A||(h=
g,A=g.childNodes.length);a&&P(a)&&U(a);c.setStart(e,u);c.setEnd(h,A);O(c)}},T=function(c,d,a){var b=d.ownerDocument.createRange();if(b.selectNode(d),a)return d=-1<c.compareBoundaryPoints(3,b),c=1>c.compareBoundaryPoints(1,b),!d&&!c;d=1>c.compareBoundaryPoints(0,b);c=-1<c.compareBoundaryPoints(2,b);return d&&c},O=function(c){for(var d,a=c.startContainer,b=c.startOffset,e=c.endContainer,f=c.endOffset;a.nodeType!==n&&(d=a.childNodes[b],d&&!J(d));)a=d,b=0;if(f)for(;e.nodeType!==n&&(d=e.childNodes[f-1],
d&&!J(d));)e=d,f=R(e);else for(;e.nodeType!==n&&(d=e.firstChild,d&&!J(d));)e=d;c.collapsed?(c.setStart(e,f),c.setEnd(a,b)):(c.setStart(a,b),c.setEnd(e,f))},ia=function(c,d){var a,b=c.startContainer,e=c.startOffset,f=c.endContainer,g=c.endOffset;for(d||(d=c.commonAncestorContainer);b!==d&&!e;)a=b.parentNode,e=z.call(a.childNodes,b),b=a;for(;f!==d&&g===R(f);)a=f.parentNode,g=z.call(a.childNodes,f)+1,f=a;c.setStart(b,e);c.setEnd(f,g)},H=function(c){var d,a=c.startContainer;return r(a)?d=Q(a).previousNode():
D(a)?d=a:(d=Ea(a,c.startOffset),d=K(d)),d&&T(c,d,!0)?d:null},ja=function(c){var d,a;a=c.endContainer;if(r(a))d=Q(a).previousNode();else if(D(a))d=a;else{if(d=Fa(a,c.endOffset),!d)for(d=a.ownerDocument.body;a=d.lastChild;)d=a;d=Q(d).previousNode()}return d&&T(c,d,!0)?d:null},I=new C(null,4|V,function(c){return c.nodeType===n?S.test(c.data):"IMG"===c.nodeName}),wa=function(c){var d=c.startContainer,a=c.startOffset;if(I.root=null,d.nodeType===n){if(a)return!1;I.currentNode=d}else I.currentNode=Fa(d,
a);return I.root=H(c),!I.previousNode()},Wa=function(c){var d,a=c.endContainer,b=c.endOffset;if(I.root=null,a.nodeType===n){if(d=a.data.length,d&&d>b)return!1;I.currentNode=a}else I.currentNode=Ea(a,b);return I.root=ja(c),!I.nextNode()},Ha=function(c){var d,a=H(c),b=ja(c);a&&b&&(d=a.parentNode,c.setStart(d,z.call(d.childNodes,a)),d=b.parentNode,c.setEnd(d,z.call(d.childNodes,b)+1))},Xa={8:"backspace",9:"tab",13:"enter",32:"space",33:"pageup",34:"pagedown",37:"left",39:"right",46:"delete",219:"[",
221:"]"},Ta=function(c){var d=c.keyCode,a=Xa[d],b="",e=this.getSelection();c.defaultPrevented||(a||(a=String.fromCharCode(d).toLowerCase(),/^[A-Za-z0-9]$/.test(a)||(a="")),Y&&46===c.which&&(a="."),111<d&&124>d&&(a="f"+(d-111)),"backspace"!==a&&"delete"!==a&&(c.altKey&&(b+="alt-"),c.ctrlKey&&(b+="ctrl-"),c.metaKey&&(b+="meta-")),c.shiftKey&&(b+="shift-"),a=b+a,this._keyHandlers[a]?this._keyHandlers[a](this,c,e):1!==a.length||e.collapsed||(this._recordUndoState(e),this._getRangeAndRemoveBookmark(e),
fa(e),this._ensureBottomLine(),this.setSelection(e),this._updatePath(e,!0)))},M=function(c){return function(d,a){a.preventDefault();d[c]()}},ca=function(c,d){return d=d||null,function(a,b){b.preventDefault();var e=a.getSelection();a.hasFormat(c,null,e)?a.changeFormat(null,{tag:c},e):a.changeFormat({tag:c},d,e)}},ga=function(c,d){try{d||(d=c.getSelection());var a,b=d.startContainer;b.nodeType===n&&(b=b.parentNode);for(a=b;r(a)&&(!a.textContent||a.textContent===da);)b=a,a=b.parentNode;b!==a&&(d.setStart(a,
z.call(a.childNodes,b)),d.collapse(!0),a.removeChild(b),D(a)||(a=Q(a).previousNode()),x(a),O(d));"BODY"===b.nodeName&&(b=b.firstChild)&&"BR"===b.nodeName&&B(b);c._ensureBottomLine();c.setSelection(d);c._updatePath(d,!0)}catch(e){c.didError(e)}},p={enter:function(c,d,a){var b,e;if(d.preventDefault(),c._recordUndoState(a),xa(a.startContainer),c._removeZWS(),c._getRangeAndRemoveBookmark(a),a.collapsed||fa(a),b=H(a),!b||/^T[HD]$/.test(b.nodeName))return N(a,c.createElement("BR")),a.collapse(!1),c.setSelection(a),
void c._updatePath(a,!0);if((e=y(b,"LI"))&&(b=e),!b.textContent){if(y(b,"UL")||y(b,"OL"))return c.modifyBlocks(ka,a);if(y(b,"BLOCKQUOTE"))return c.modifyBlocks(Ya,a)}e=b;var f=Za[e.nodeName],g=null;a=F(a.startContainer,a.startOffset,e.parentNode);d=c._config;d=(f||(f=d.blockTag,g=d.blockAttributes),na(a,f,g)||(e=t(a.ownerDocument,f,g),a.dir&&(e.dir=a.dir),E(a,e),e.appendChild(w(a)),a=e),a);Ia(b);Ja(b);for(x(b);d.nodeType===v;){var k;b=d.firstChild;if("A"===d.nodeName&&(!d.textContent||d.textContent===
da)){b=c._doc.createTextNode("");E(d,b);d=b;break}for(;b&&b.nodeType===n&&!b.data&&(k=b.nextSibling,k&&"BR"!==k.nodeName);)B(b),b=k;if(!b||"BR"===b.nodeName||b.nodeType===n&&!Y)break;d=b}a=c._createRange(d,0);c.setSelection(a);c._updatePath(a,!0);d.nodeType===n&&(d=d.parentNode);d.getBoundingClientRect().top+16>c._doc.documentElement.clientHeight&&d.scrollIntoView(!1)},backspace:function(c,d,a){if(c._removeZWS(),c._recordUndoState(a),c._getRangeAndRemoveBookmark(a),a.collapsed)if(wa(a)){d.preventDefault();
var b=(d=H(a))&&Q(d).previousNode();if(b){if(!b.isContentEditable)return void B(b);sa(b,d,a);for(d=b.parentNode;d&&!d.nextSibling;)d=d.parentNode;d&&(d=d.nextSibling)&&U(d);c.setSelection(a)}else if(d){if(y(d,"UL")||y(d,"OL"))return c.modifyBlocks(ka,a);if(y(d,"BLOCKQUOTE"))return c.modifyBlocks(Ka,a);c.setSelection(a);c._updatePath(a,!0)}}else c.setSelection(a),setTimeout(function(){ga(c)},0);else d.preventDefault(),fa(a),ga(c,a)},"delete":function(c,d,a){if(c._removeZWS(),c._recordUndoState(a),
c._getRangeAndRemoveBookmark(a),a.collapsed)if(Wa(a)){d.preventDefault();var b=(d=H(a))&&K(d);if(b){if(!b.isContentEditable)return void B(b);sa(d,b,a);for(b=d.parentNode;b&&!b.nextSibling;)b=b.parentNode;b&&(b=b.nextSibling)&&U(b);c.setSelection(a);c._updatePath(a,!0)}}else{var e,f,g=a.cloneRange();if(ia(a,c._body),b=a.endContainer,e=a.endOffset,b.nodeType===v&&(f=b.childNodes[e],f&&"IMG"===f.nodeName))return d.preventDefault(),B(f),O(a),void ga(c,a);c.setSelection(g);setTimeout(function(){ga(c)},
0)}else d.preventDefault(),fa(a),ga(c,a)},tab:function(c,d,a){var b,e;if(c._removeZWS(),a.collapsed&&wa(a))for(b=H(a);e=b.parentNode;){if("UL"===e.nodeName||"OL"===e.nodeName){b.previousSibling&&(d.preventDefault(),c.modifyBlocks(La,a));break}b=e}},"shift-tab":function(c,d,a){if(c._removeZWS(),a.collapsed&&wa(a)){var b=a.startContainer;(y(b,"UL")||y(b,"OL"))&&(d.preventDefault(),c.modifyBlocks(ka,a))}},space:function(c,d,a){var b;c._recordUndoState(a);xa(a.startContainer);c._getRangeAndRemoveBookmark(a);
d=a.endContainer;b=d.parentNode;a.collapsed&&"A"===b.nodeName&&!d.nextSibling&&a.endOffset===R(d)&&a.setStartAfter(b);c.setSelection(a)},left:function(c){c._removeZWS()},right:function(c){c._removeZWS()}};h&&Da&&L.getSelection().modify&&(p["meta-left"]=function(c,d){d.preventDefault();c._sel.modify("move","backward","lineboundary")},p["meta-right"]=function(c,d){d.preventDefault();c._sel.modify("move","forward","lineboundary")});h||(p.pageup=function(c){c.moveCursorToStart()},p.pagedown=function(c){c.moveCursorToEnd()});
p[l+"b"]=ca("B");p[l+"i"]=ca("I");p[l+"u"]=ca("U");p[l+"shift-7"]=ca("S");p[l+"shift-5"]=ca("SUB",{tag:"SUP"});p[l+"shift-6"]=ca("SUP",{tag:"SUB"});p[l+"shift-8"]=M("makeUnorderedList");p[l+"shift-9"]=M("makeOrderedList");p[l+"["]=M("decreaseQuoteLevel");p[l+"]"]=M("increaseQuoteLevel");p[l+"y"]=M("redo");p[l+"z"]=M("undo");p[l+"shift-z"]=M("redo");var $a={1:10,2:13,3:16,4:18,5:24,6:32,7:48},Ma={backgroundColor:{regexp:S,replace:function(c,d){return t(c,"SPAN",{"class":"highlight",style:"background-color: "+
d})}},color:{regexp:S,replace:function(c,d){return t(c,"SPAN",{"class":"colour",style:"color:"+d})}},fontWeight:{regexp:/^bold/i,replace:function(c){return t(c,"B")}},fontStyle:{regexp:/^italic/i,replace:function(c){return t(c,"I")}},fontFamily:{regexp:S,replace:function(c,d){return t(c,"SPAN",{"class":"font",style:"font-family:"+d})}},fontSize:{regexp:S,replace:function(c,d){return t(c,"SPAN",{"class":"size",style:"font-size:"+d})}}},h=function(c){return function(d,a){var b=t(d.ownerDocument,c);
return a.replaceChild(b,d),b.appendChild(w(d)),b}},ab={SPAN:function(c,d){var a,b,e,f,g,k,u=c.style,h=c.ownerDocument;for(a in Ma)b=Ma[a],(e=u[a])&&b.regexp.test(e)&&(k=b.replace(h,e),f&&f.appendChild(k),f=k,g||(g=k));return g&&(f.appendChild(w(c)),d.replaceChild(g,c)),f||c},STRONG:h("B"),EM:h("I"),STRIKE:h("S"),FONT:function(c,d){var a,b,e,f,g,k=c.face,h=c.size,q=c.color,A=c.ownerDocument;return k&&(a=t(A,"SPAN",{"class":"font",style:"font-family:"+k}),g=a,f=a),h&&(b=t(A,"SPAN",{"class":"size",style:"font-size:"+
$a[h]+"px"}),g||(g=b),f&&f.appendChild(b),f=b),q&&/^#?([\dA-F]{3}){1,2}$/i.test(q)&&("#"!==q.charAt(0)&&(q="#"+q),e=t(A,"SPAN",{"class":"colour",style:"color:"+q}),g||(g=e),f&&f.appendChild(e),f=e),g||(g=f=t(A,"SPAN")),d.replaceChild(g,c),f.appendChild(w(c)),f},TT:function(c,d){var a=t(c.ownerDocument,"SPAN",{"class":"font",style:'font-family:menlo,consolas,"courier new",monospace'});return d.replaceChild(a,c),a.appendChild(w(c)),a}},bb=/^(?:A(?:DDRESS|RTICLE|SIDE|UDIO)|BLOCKQUOTE|CAPTION|D(?:[DLT]|IV)|F(?:IGURE|IGCAPTION|OOTER)|H[1-6]|HEADER|L(?:ABEL|EGEND|I)|O(?:L|UTPUT)|P(?:RE)?|SECTION|T(?:ABLE|BODY|D|FOOT|H|HEAD|R)|UL)$/,
cb=/^(?:HEAD|META|STYLE)/,ha=new C(null,4|V,function(){return!0}),Na=function d(a){var b,e,f,g,k,h,q,A,m,l,G,t=a.childNodes;for(b=a;r(b);)b=b.parentNode;ha.root=b;b=0;for(e=t.length;e>b;b+=1)if(f=t[b],g=f.nodeName,k=f.nodeType,h=ab[g],k===v){if(q=f.childNodes.length,h)f=h(f,a);else{if(cb.test(g)){a.removeChild(f);--b;--e;continue}if(!bb.test(g)&&!r(f)){--b;e+=q-1;a.replaceChild(w(f),f);continue}}q&&d(f)}else{if(k===n){if(l=f.data,A=!S.test(l.charAt(0)),m=!S.test(l.charAt(l.length-1)),!A&&!m)continue;
if(A){for(ha.currentNode=f;(G=ha.previousPONode())&&(g=G.nodeName,!("IMG"===g||"#text"===g&&/\S/.test(G.data)));)if(!r(G)){G=null;break}G||(l=l.replace(/^\s+/g,""))}if(m){for(ha.currentNode=f;(G=ha.nextNode())&&!("IMG"===g||"#text"===g&&/\S/.test(G.data));)if(!r(G)){G=null;break}G||(l=l.replace(/^\s+/g,""))}if(l){f.data=l;continue}}a.removeChild(f);--b;--e}return a},Ja=function a(b){for(var e,f=b.childNodes,g=f.length;g--;)e=f[g],e.nodeType!==v||J(e)?e.nodeType!==n||e.data||b.removeChild(e):(a(e),
r(e)&&!e.firstChild&&b.removeChild(e))},db=function(a){return a.nodeType===v?"BR"===a.nodeName:S.test(a.data)},Oa=function(a){var b,e;a=a.querySelectorAll("BR");var f=[],g=a.length;for(b=0;g>b;b+=1){e=b;var k;k=a[b];for(var h=void 0,q=k.parentNode;r(q);)q=q.parentNode;k=(h=new C(q,V|4,db),h.currentNode=k,!!h.nextNode());f[e]=k}for(;g--;)b=a[g],(e=b.parentNode)&&(f[g]?r(e)||W(e):B(b))},Ra=function(){var a=this.getSelection(),b=this;this._recordUndoState(a);this._getRangeAndRemoveBookmark(a);this.setSelection(a);
setTimeout(function(){try{b._ensureBottomLine()}catch(a){b.didError(a)}},0)},Sa=function(a){var b,e,f,g=a.clipboardData,k=g&&g.items,h=!1,q=!1,l=null,m=this;if(k){a.preventDefault();for(a=k.length;a--;){if(b=k[a],e=b.type,"text/html"===e)return void b.getAsString(function(a){m.insertHTML(a,!0)});"text/plain"===e&&(l=b);/^image\/.*/.test(e)&&(q=!0)}return void(q?(this.fireEvent("dragover",{dataTransfer:g,preventDefault:function(){h=!0}}),h&&this.fireEvent("drop",{dataTransfer:g})):l&&b.getAsString(function(a){m.insertPlainText(a,
!0)}))}if(g&&(-1<z.call(g.types,"text/html")||-1<z.call(g.types,"text/plain")&&0>z.call(g.types,"text/rtf")))return a.preventDefault(),void((f=g.getData("text/html"))?this.insertHTML(f,!0):(f=g.getData("text/plain"))&&this.insertPlainText(f,!0));this._awaitingPaste=!0;b=this._body;e=this.getSelection();var n=e.startContainer,r=e.startOffset,t=e.endContainer,eb=e.endOffset,g=H(e),p=this.createElement("DIV",{style:"position: absolute; overflow: hidden; top:"+(b.scrollTop+(g?g.getBoundingClientRect().top:
0))+"px; right: 150%; width: 1px; height: 1px;"});b.appendChild(p);e.selectNodeContents(p);this.setSelection(e);setTimeout(function(){try{m._awaitingPaste=!1;for(var a,b,e="",f=p;p=f;)f=p.nextSibling,B(p),(a=p.firstChild)&&a===p.lastChild&&"DIV"===a.nodeName&&(p=a),e+=p.innerHTML;b=m._createRange(n,r,t,eb);m.setSelection(b);e&&m.insertHTML(e,!0)}catch(g){m.didError(g)}},0)},Z=[],h=ea.prototype;h.setConfig=function(a){return a=ta({blockTag:"DIV",blockAttributes:null,tagAttributes:{blockquote:null,
ul:null,ol:null,li:null}},a),a.blockTag=a.blockTag.toUpperCase(),this._config=a,this};h.createElement=function(a,b,e){return t(this._doc,a,b,e)};h.createDefaultBlock=function(a){var b=this._config;return x(this.createElement(b.blockTag,b.blockAttributes,a))};h.didError=function(a){console.log(a)};h.getDocument=function(){return this._doc};var ya={focus:1,blur:1,pathChange:1,select:1,input:1,undoStateChange:1};h.fireEvent=function(a,b){var e,f,g=this._events[a];if(g)for(b||(b={}),b.type!==a&&(b.type=
a),g=g.slice(),e=g.length;e--;){f=g[e];try{f.handleEvent?f.handleEvent(b):f.call(this,b)}catch(k){k.details="Squire: fireEvent error. Event type: "+a,this.didError(k)}}return this};h.destroy=function(){var a,b=this._win,e=this._doc,f=this._events;b.removeEventListener("focus",this,!1);b.removeEventListener("blur",this,!1);for(a in f)ya[a]||e.removeEventListener(a,this,!0);this._mutation&&this._mutation.disconnect();for(a=Z.length;a--;)Z[a]===this&&Z.splice(a,1)};h.handleEvent=function(a){this.fireEvent(a.type,
a)};h.addEventListener=function(a,b){var e=this._events[a];return b?(e||(e=this._events[a]=[],ya[a]||this._doc.addEventListener(a,this,!0)),e.push(b),this):(this.didError({name:"Squire: addEventListener with null or undefined fn",message:"Event type: "+a}),this)};h.removeEventListener=function(a,b){var e,f=this._events[a];if(f){for(e=f.length;e--;)f[e]===b&&f.splice(e,1);f.length||(delete this._events[a],ya[a]||this._doc.removeEventListener(a,this,!1))}return this};h._createRange=function(a,b,e,f){if(a instanceof
this._win.Range)return a.cloneRange();var g=this._doc.createRange();return g.setStart(a,b),e?g.setEnd(e,f):g.setEnd(a,b),g};h._moveCursorTo=function(a){var b=this._body;a=this._createRange(b,a?0:b.childNodes.length);return O(a),this.setSelection(a),this};h.moveCursorToStart=function(){return this._moveCursorTo(!0)};h.moveCursorToEnd=function(){return this._moveCursorTo(!1)};h.setSelection=function(a){if(a){Ua&&this._win.focus();var b=this._getWindowSelection();b&&(b.removeAllRanges(),b.addRange(a))}return this};
h._getWindowSelection=function(){return this._win.getSelection()||null};h.getSelection=function(){var a,b,e,f=this._getWindowSelection();return f&&f.rangeCount?(a=f.getRangeAt(0).cloneRange(),b=a.startContainer,e=a.endContainer,b&&J(b)&&a.setStartBefore(b),e&&J(e)&&a.setEndBefore(e),this._lastSelection=a):a=this._lastSelection,a||(a=this._createRange(this._body.firstChild,0)),a};h.getSelectedText=function(){var a,b=this.getSelection(),e=new C(b.commonAncestorContainer,4|V,function(a){return T(b,a,
!0)}),f=b.startContainer,g=b.endContainer,k=e.currentNode=f,h="",q=!1;for(e.filter(k)||(k=e.nextNode());k;)k.nodeType===n?(a=k.data,a&&/\S/.test(a)&&(k===g&&(a=a.slice(0,b.endOffset)),k===f&&(a=a.slice(b.startOffset)),h+=a,q=!0)):("BR"===k.nodeName||q&&!r(k))&&(h+="\n",q=!1),k=e.nextNode();return h};h.getPath=function(){return this._path};var Ia=function(a){for(var b,e=new C(a,4,function(){return!0},!1);a=e.nextNode();)for(;-1<(b=a.data.indexOf(da));){if(1===a.length){do b=a.parentNode,b.removeChild(a),
a=b;while(r(a)&&!R(a));break}a.deleteData(b,1)}};h._didAddZWS=function(){this._hasZWS=!0};h._removeZWS=function(){this._hasZWS&&(Ia(this._body),this._hasZWS=!1)};h._updatePath=function(a,b){var e,f=a.startContainer,g=a.endContainer;(b||f!==this._lastAnchorNode||g!==this._lastFocusNode)&&(this._lastAnchorNode=f,this._lastFocusNode=g,e=f&&g?f===g?oa(g):"(selection)":"",this._path!==e&&(this._path=e,this.fireEvent("pathChange",{path:e})));a.collapsed||this.fireEvent("select")};h._updatePathOnEvent=function(){this._updatePath(this.getSelection())};
h.focus=function(){return Y||this._body.focus(),this._win.focus(),this};h.blur=function(){return Da&&this._body.blur(),top.focus(),this};h._saveRangeToBookmark=function(a){var b,e=this.createElement("INPUT",{id:"squire-selection-start",type:"hidden"}),f=this.createElement("INPUT",{id:"squire-selection-end",type:"hidden"});N(a,e);a.collapse(!1);N(a,f);e.compareDocumentPosition(f)&2&&(e.id="squire-selection-end",f.id="squire-selection-start",b=e,e=f,f=b);a.setStartAfter(e);a.setEndBefore(f)};h._getRangeAndRemoveBookmark=
function(a){var b=this._doc,e=b.getElementById("squire-selection-start"),f=b.getElementById("squire-selection-end");if(e&&f){var g=e.parentNode,k=f.parentNode,h={startContainer:g,endContainer:k,startOffset:z.call(g.childNodes,e),endOffset:z.call(k.childNodes,f)};g===k&&--h.endOffset;B(e);B(f);X(g,h);g!==k&&X(k,h);a||(a=b.createRange());a.setStart(h.startContainer,h.startOffset);a.setEnd(h.endContainer,h.endOffset);b=a.collapsed;O(a);b&&a.collapse(!0)}return a||null};h._keyUpDetectChange=function(a){var b=
a.keyCode;a.ctrlKey||a.metaKey||a.altKey||!(16>b||20<b)||!(33>b||45<b)||this._docWasChanged()};h._docWasChanged=function(){return aa&&this._ignoreChange?void(this._ignoreChange=!1):(this._isInUndoState&&(this._isInUndoState=!1,this.fireEvent("undoStateChange",{canUndo:!0,canRedo:!1})),void this.fireEvent("input"))};h._recordUndoState=function(a){if(!this._isInUndoState){var b=this._undoIndex+=1,e=this._undoStack;b<this._undoStackLength&&(e.length=this._undoStackLength=b);a&&this._saveRangeToBookmark(a);
e[b]=this._getHTML();this._undoStackLength+=1;this._isInUndoState=!0}};h.undo=function(){if(0!==this._undoIndex||!this._isInUndoState){this._recordUndoState(this.getSelection());--this._undoIndex;this._setHTML(this._undoStack[this._undoIndex]);var a=this._getRangeAndRemoveBookmark();a&&this.setSelection(a);this._isInUndoState=!0;this.fireEvent("undoStateChange",{canUndo:0!==this._undoIndex,canRedo:!0});this.fireEvent("input")}return this};h.redo=function(){var a=this._undoIndex,b=this._undoStackLength;
if(b>a+1&&this._isInUndoState){this._undoIndex+=1;this._setHTML(this._undoStack[this._undoIndex]);var e=this._getRangeAndRemoveBookmark();e&&this.setSelection(e);this.fireEvent("undoStateChange",{canUndo:!0,canRedo:b>a+2});this.fireEvent("input")}return this};h.hasFormat=function(a,b,e){if(a=a.toUpperCase(),b||(b={}),!e&&!(e=this.getSelection()))return!1;!e.collapsed&&e.startContainer.nodeType===n&&e.startOffset===e.startContainer.length&&e.startContainer.nextSibling&&e.setStartBefore(e.startContainer.nextSibling);
!e.collapsed&&e.endContainer.nodeType===n&&0===e.endOffset&&e.endContainer.previousSibling&&e.setEndAfter(e.endContainer.previousSibling);var f,g;f=e.commonAncestorContainer;if(y(f,a,b))return!0;if(f.nodeType===n)return!1;f=new C(f,4,function(a){return T(e,a,!0)},!1);for(var k=!1;g=f.nextNode();){if(!y(g,a,b))return!1;k=!0}return k};h.getFontInfo=function(a){var b,e,f={family:ma,size:ma};if(!a&&!(a=this.getSelection()))return f;if(b=a.commonAncestorContainer,a.collapsed||b.nodeType===n)for(b.nodeType===
n&&(b=b.parentNode);(!f.family||!f.size)&&b&&(e=b.style);)f.family||(f.family=e.fontFamily),f.size||(f.size=e.fontSize),b=b.parentNode;return f};h._addFormat=function(a,b,e){var f,g,k,h,q,l,m,r;if(e.collapsed)f=x(this.createElement(a,b)),N(e,f),e.setStart(f.firstChild,f.firstChild.length),e.collapse(!0);else{if(g=new C(e.commonAncestorContainer,4|V,function(a){return(a.nodeType===n||"BR"===a.nodeName||"IMG"===a.nodeName)&&T(e,a,!0)},!1),k=e.startContainer,q=e.startOffset,h=e.endContainer,l=e.endOffset,
g.currentNode=k,g.filter(k)||(k=g.nextNode(),q=0),!k)return e;do m=g.currentNode,(r=!y(m,a,b))&&(m===h&&m.length>l&&m.splitText(l),m===k&&q&&(m=m.splitText(q),h===k&&(h=m,l-=q),k=m,q=0),f=this.createElement(a,b),E(m,f),f.appendChild(m));while(g.nextNode());h.nodeType!==n&&(m.nodeType===n?(h=m,l=m.length):(h=m.parentNode,l=1));e=this._createRange(k,q,h,l)}return e};h._removeFormat=function(a,b,e,f){this._saveRangeToBookmark(e);var g,k=this._doc;e.collapsed&&(qa?(g=k.createTextNode(da),this._didAddZWS()):
g=k.createTextNode(""),N(e,g));for(k=e.commonAncestorContainer;r(k);)k=k.parentNode;var h=e.startContainer,l=e.startOffset,A=e.endContainer,m=e.endOffset,p=[],t=function(a,b){if(!T(e,a,!1)){var f,g;f=a.nodeType===n;if(!T(e,a,!0))return void("INPUT"===a.nodeName||f&&!a.data||p.push([b,a]));if(f)a===A&&m!==a.length&&p.push([b,a.splitText(m)]),a===h&&l&&(a.splitText(l),p.push([b,a]));else for(f=a.firstChild;f;f=g)g=f.nextSibling,t(f,b)}},v=Array.prototype.filter.call(k.getElementsByTagName(a),function(f){return T(e,
f,!0)&&na(f,a,b)});f||v.forEach(function(a){t(a,a)});p.forEach(function(a){var b=a[0].cloneNode(!1);a=a[1];E(a,b);b.appendChild(a)});v.forEach(function(a){E(a,w(a))});this._getRangeAndRemoveBookmark(e);g&&e.collapse(!1);f={startContainer:e.startContainer,startOffset:e.startOffset,endContainer:e.endContainer,endOffset:e.endOffset};return X(k,f),e.setStart(f.startContainer,f.startOffset),e.setEnd(f.endContainer,f.endOffset),e};h.changeFormat=function(a,b,e,f){return e||(e=this.getSelection())?(this._recordUndoState(e),
this._getRangeAndRemoveBookmark(e),b&&(e=this._removeFormat(b.tag.toUpperCase(),b.attributes||{},e,f)),a&&(e=this._addFormat(a.tag.toUpperCase(),a.attributes||{},e)),this.setSelection(e),this._updatePath(e,!0),aa||this._docWasChanged(),this):void 0};var Za={DT:"DD",DD:"DT",LI:"LI"};h.forEachBlock=function(a,b,e){if(!e&&!(e=this.getSelection()))return this;b&&(this._recordUndoState(e),this._getRangeAndRemoveBookmark(e));var f=H(e),g=ja(e);if(f&&g){do if(a(f)||f===g)break;while(f=K(f))}return b&&(this.setSelection(e),
this._updatePath(e,!0),aa||this._docWasChanged()),this};h.modifyBlocks=function(a,b){if(!b&&!(b=this.getSelection()))return this;this._isInUndoState?this._saveRangeToBookmark(b):this._recordUndoState(b);Ha(b);var e,f=this._body;return ia(b,f),e=Ga(b,f),N(b,a.call(this,e)),b.endOffset<b.endContainer.childNodes.length&&U(b.endContainer.childNodes[b.endOffset]),U(b.startContainer.childNodes[b.startOffset]),this._getRangeAndRemoveBookmark(b),this.setSelection(b),this._updatePath(b,!0),aa||this._docWasChanged(),
this};var Ka=function(a){var b=a.querySelectorAll("blockquote");return Array.prototype.filter.call(b,function(a){return!y(a.parentNode,"BLOCKQUOTE")}).forEach(function(a){E(a,w(a))}),a},Ya=function(){return this.createDefaultBlock([this.createElement("INPUT",{id:"squire-selection-start",type:"hidden"}),this.createElement("INPUT",{id:"squire-selection-end",type:"hidden"})])},Pa=function(a,b,e){var f,g,k,h;b=Q(b);f=a._config.tagAttributes;for(var l=f[e.toLowerCase()],n=f.li;f=b.nextNode();)g=f.parentNode.nodeName,
"LI"!==g?(h=a.createElement("LI",n),f.dir&&(h.dir=f.dir),(k=f.previousSibling)&&k.nodeName===e?k.appendChild(h):E(f,a.createElement(e,l,[h])),h.appendChild(f)):(f=f.parentNode.parentNode,g=f.nodeName,g!==e&&/^[OU]L$/.test(g)&&E(f,a.createElement(e,l,[w(f)])))},La=function(a){var b,e,f,g,k,h,l=a.querySelectorAll("LI"),n=this._config.tagAttributes,m=n.li;b=0;for(e=l.length;e>b;b+=1)f=l[b],P(f.firstChild)||(g=f.parentNode.nodeName,k=f.previousSibling,k&&(k=k.lastChild)&&k.nodeName===g||(h=n[g.toLowerCase()],
E(f,this.createElement("LI",m,[k=this.createElement(g,h)]))),k.appendChild(f));return a},ka=function(a){var b=a.querySelectorAll("LI");return Array.prototype.filter.call(b,function(a){return!P(a.firstChild)}).forEach(function(b){var f,g=b.parentNode,k=g.parentNode,h=b.firstChild,l=h;for(b.previousSibling&&(g=F(g,b,k));l&&(f=l.nextSibling,!P(l));)k.insertBefore(l,g),l=f;for("LI"===k.nodeName&&h.previousSibling&&F(k,h,k.parentNode);b!==a&&!b.childNodes.length;)g=b.parentNode,g.removeChild(b),b=g},this),
W(a),a};h._ensureBottomLine=function(){var a=this._body,b=a.lastElementChild;b&&b.nodeName===this._config.blockTag&&D(b)||a.appendChild(this.createDefaultBlock())};h.setKeyHandler=function(a,b){return this._keyHandlers[a]=b,this};h._getHTML=function(){return this._body.innerHTML};h._setHTML=function(a){var b=this._body;b.innerHTML=a;do x(b);while(b=K(b));this._ignoreChange=!0};h.getHTML=function(a){var b,e,f=[];if(a&&(e=this.getSelection())&&this._saveRangeToBookmark(e),ra)for(a=this._body;a=K(a);)a.textContent||
a.querySelector("BR")||(b=this.createElement("BR"),a.appendChild(b),f.push(b));if(b=this._getHTML().replace(/\u200B/g,""),ra)for(a=f.length;a--;)B(f[a]);return e&&this._getRangeAndRemoveBookmark(e),b};h.setHTML=function(a){var b=this._doc.createDocumentFragment(),e=this.createElement("DIV");e.innerHTML=a;b.appendChild(w(e));Na(b);Oa(b);W(b);for(a=b;a=K(a);)x(a);this._ignoreChange=!0;for(e=this._body;a=e.lastChild;)e.removeChild(a);e.appendChild(b);x(e);this._undoIndex=-1;this._undoStackLength=this._undoStack.length=
0;this._isInUndoState=!1;b=this._getRangeAndRemoveBookmark()||this._createRange(e.firstChild,0);return this._recordUndoState(b),this._getRangeAndRemoveBookmark(b),Ca?this._lastSelection=b:this.setSelection(b),this._updatePath(b,!0),this};h.insertElement=function(a,b){if(b||(b=this.getSelection()),b.collapse(!0),r(a))N(b,a),b.setStartAfter(a);else{for(var e,f,g=this._body,k=H(b)||g;k!==g&&!k.nextSibling;)k=k.parentNode;k!==g&&(e=k.parentNode,f=F(e,k.nextSibling,g));f?g.insertBefore(a,f):(g.appendChild(a),
f=this.createDefaultBlock(),g.appendChild(f));b.setStart(f,0);b.setEnd(f,0);O(b)}return this.focus(),this.setSelection(b),this._updatePath(b),this};h.insertImage=function(a,b){var e=this.createElement("IMG",ta({src:a},b));return this.insertElement(e),e};var fb=/\b((?:(?:ht|f)tps?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,}\/)(?:[^\s()<>]+|\([^\s()<>]+\))+(?:\((?:[^\s()<>]+|(?:\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?\u00ab\u00bb\u201c\u201d\u2018\u2019]))|([\w\-.%+]+@(?:[\w\-]+\.)+[A-Z]{2,}\b)/i,
xa=function(a){for(var b,e,f,g,k,h,l=a.ownerDocument,n=new C(a,4,function(a){return!y(a,"A")},!1);a=n.nextNode();)for(b=a.data,e=a.parentNode;f=fb.exec(b);)g=f.index,k=g+f[0].length,g&&(h=l.createTextNode(b.slice(0,g)),e.insertBefore(h,a)),h=l.createElement("A"),h.textContent=b.slice(g,k),h.href=f[1]?/^(?:ht|f)tps?:/.test(f[1])?f[1]:"http://"+f[1]:"mailto:"+f[2],e.insertBefore(h,a),a.data=b=b.slice(k)};h.insertHTML=function(a,b){var e=this.getSelection(),f=this._doc.createDocumentFragment(),g=this.createElement("DIV");
g.innerHTML=a;f.appendChild(w(g));this._recordUndoState(e);this._getRangeAndRemoveBookmark(e);try{var g=f,h={fragment:f,preventDefault:function(){this.defaultPrevented=!0},defaultPrevented:!1};xa(f);Na(f);Oa(f);Ja(f);for(f.normalize();g=K(g);)x(g);b&&this.fireEvent("willPaste",h);h.defaultPrevented||(Va(e,h.fragment),aa||this._docWasChanged(),e.collapse(!1),this._ensureBottomLine());this.setSelection(e);this._updatePath(e,!0)}catch(l){this.didError(l)}return this};h.insertPlainText=function(a,b){var e,
f,g,h=a.split("\n");e=0;for(f=h.length;f>e;e+=1)g=h[e],g=g.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").replace(/ (?= )/g,"&nbsp;"),e&&f>e+1&&(g="<DIV>"+(g||"<BR>")+"</DIV>"),h[e]=g;return this.insertHTML(h.join(""),b)};l=function(a,b,e){return function(){return this[a](b,e),this.focus()}};h.addStyles=function(a){if(a){var b=this._doc.documentElement.firstChild,e=this.createElement("STYLE",{type:"text/css"});e.appendChild(this._doc.createTextNode(a));b.appendChild(e)}return this};
h.bold=l("changeFormat",{tag:"B"});h.italic=l("changeFormat",{tag:"I"});h.underline=l("changeFormat",{tag:"U"});h.strikethrough=l("changeFormat",{tag:"S"});h.subscript=l("changeFormat",{tag:"SUB"},{tag:"SUP"});h.superscript=l("changeFormat",{tag:"SUP"},{tag:"SUB"});h.removeBold=l("changeFormat",null,{tag:"B"});h.removeItalic=l("changeFormat",null,{tag:"I"});h.removeUnderline=l("changeFormat",null,{tag:"U"});h.removeStrikethrough=l("changeFormat",null,{tag:"S"});h.removeSubscript=l("changeFormat",
null,{tag:"SUB"});h.removeSuperscript=l("changeFormat",null,{tag:"SUP"});h.makeLink=function(a,b){var e=this.getSelection();if(e.collapsed){var f=a.indexOf(":")+1;if(f)for(;"/"===a[f];)f+=1;N(e,this._doc.createTextNode(a.slice(f)))}return b||(b={}),b.href=a,this.changeFormat({tag:"A",attributes:b},{tag:"A"},e),this.focus()};h.removeLink=function(){return this.changeFormat(null,{tag:"A"},this.getSelection(),!0),this.focus()};h.setFontFace=function(a){return this.changeFormat({tag:"SPAN",attributes:{"class":"font",
style:"font-family: "+a+", sans-serif;"}},{tag:"SPAN",attributes:{"class":"font"}}),this.focus()};h.setFontSize=function(a){return this.changeFormat({tag:"SPAN",attributes:{"class":"size",style:"font-size: "+("number"==typeof a?a+"px":a)}},{tag:"SPAN",attributes:{"class":"size"}}),this.focus()};h.setTextColour=function(a){return this.changeFormat({tag:"SPAN",attributes:{"class":"colour",style:"color: "+a}},{tag:"SPAN",attributes:{"class":"colour"}}),this.focus()};h.setHighlightColour=function(a){return this.changeFormat({tag:"SPAN",
attributes:{"class":"highlight",style:"background-color: "+a}},{tag:"SPAN",attributes:{"class":"highlight"}}),this.focus()};h.setTextAlignment=function(a){return this.forEachBlock(function(b){b.className=(b.className.split(/\s+/).filter(function(a){return!/align/.test(a)}).join(" ")+" align-"+a).trim();b.style.textAlign=a},!0),this.focus()};h.setTextDirection=function(a){return this.forEachBlock(function(b){b.dir=a},!0),this.focus()};h.removeAllFormatting=function(a){if(!a&&!(a=this.getSelection())||
a.collapsed)return this;for(var b=a.commonAncestorContainer;b&&!D(b);)b=b.parentNode;if(b||(Ha(a),b=this._body),b.nodeType===n)return this;this._recordUndoState(a);this._getRangeAndRemoveBookmark(a);ia(a,b);for(var e,f,g,h=b.ownerDocument,l=a.startContainer,q=a.startOffset,p=a.endContainer,m=a.endOffset,r=h.createDocumentFragment(),h=h.createDocumentFragment(),p=F(p,m,b),l=F(l,q,b);l!==p;)e=l.nextSibling,r.appendChild(l),l=e;return ua(this,r,h),h.normalize(),l=h.firstChild,e=h.lastChild,g=b.childNodes,
l?(b.insertBefore(h,p),q=z.call(g,l),m=z.call(g,e)+1):(q=z.call(g,p),m=q),f={startContainer:b,startOffset:q,endContainer:b,endOffset:m},X(b,f),a.setStart(f.startContainer,f.startOffset),a.setEnd(f.endContainer,f.endOffset),O(a),this.setSelection(a),this._updatePath(a,!0),this.focus()};h.increaseQuoteLevel=l("modifyBlocks",function(a){return this.createElement("BLOCKQUOTE",this._config.tagAttributes.blockquote,[a])});h.decreaseQuoteLevel=l("modifyBlocks",Ka);h.makeUnorderedList=l("modifyBlocks",function(a){return Pa(this,
a,"UL"),a});h.makeOrderedList=l("modifyBlocks",function(a){return Pa(this,a,"OL"),a});h.removeList=l("modifyBlocks",function(a){var b,e,f,g,h,l,n,p=a.querySelectorAll("UL, OL");b=0;for(e=p.length;e>b;b+=1){g=p[b];h=w(g);l=h.childNodes;for(f=l.length;f--;)n=l[f],E(n,w(n));W(h);E(g,h)}return a});h.increaseListLevel=l("modifyBlocks",La);h.decreaseListLevel=l("modifyBlocks",ka);"object"==typeof exports?module.exports=ea:"function"==typeof define&&define.amd?define(function(){return ea}):(L.Squire=ea,
top!==L&&"true"===la.documentElement.getAttribute("data-squireinit")&&(L.editor=new ea(la),L.onEditorLoad&&(L.onEditorLoad(L.editor),L.onEditorLoad=null)))}(document);

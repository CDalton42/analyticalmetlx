var DeviceConfiguration=function(){var E=Date.now(),m="browser",F=function(){var b=!1;try{b="jid"in Conversations.getCurrentConversation()}catch(a){b=!1}return"projector"!=m&&b},k={tools:!1,slides:!1,header:!1,keyboard:!1,footer:!1},e=function(b,a){F&&("header"==b||1!=a&&0!=a||(k[b]=a))},r=function(){m=null!=navigator.userAgent.match(/iPhone/i)||null!=navigator.userAgent.match(/iPod/i)?"iPhone":null!=navigator.userAgent.match(/iPad/i)?"iPad":null!=navigator.userAgent.match("Trident/7.0")?"IE11+":
"browser"},p=function(){r();$("#absoluteCloseButton").removeClass("closeButton").text("").click(bounceAnd(function(){}));$("#applicationMenuButton").show();f=y;try{"Conversations"in window&&"jid"in Conversations.getCurrentConversation()&&("UserSettings"in window&&UserSettings.getIsInteractive()?(DeviceConfiguration.setHeader(!0),DeviceConfiguration.setTools(!0),DeviceConfiguration.setSlides(!0),DeviceConfiguration.setFooter(!0)):(DeviceConfiguration.setHeader(!1),DeviceConfiguration.setTools(!1),
DeviceConfiguration.setSlides(!1),DeviceConfiguration.setFooter(!1)))}catch(b){console.log("error while trying to fix the layout:",b)}zoomToPage(!0);f()},H=function(){Conversations.enableSyncMove();UserSettings.setIsInteractive(!1);m="projector";e("tools",!1);e("slides",!1);e("header",!1);e("footer",!1);f=G;zoomToFit(!0);$("#absoluteCloseButton").addClass("closeButton").text("X").click(bounceAnd(function(){UserSettings.setIsInteractive(!0);p()}));$("#applicationMenuButton").hide();Modes.none.activate();
f()},C=function(){var b=screen.width,a=screen.height,d;"orientation"in window?(d=window.orientation,d=90==d||-90==d):d=window.innerWidth>window.innerHeight;"landscape"==(d?"landscape":"portrait")&&b<a&&(b=screen.height,a=screen.width);d=window.innerWidth;var c=window.innerHeight;if(!d||!c||d>b||c>a||980==d)d=window.outerWidth,c=window.outerHeight;if(!d||!c||d>b||c>a)d=screen.availWidth,c=screen.availHeight;return{width:d,height:c}},y=function(){D(k.header,k.tools,k.slides,k.keyboard)},f=y,G=function(){D(!1,
!1,!1,!1)},g=function(b){b=parseInt(b.split("px")[0]);return isNaN(b)?0:b},w=function(b){return{x:_.sum(_.map(b,function(a){var b=g(a.css("margin-left"))+g(a.css("padding-left"))+g(a.css("border"));a=g(a.css("margin-right"))+g(a.css("padding-right"))+g(a.css("border"));return b+a})),y:_.sum(_.map(b,function(a){var b=g(a.css("margin-top"))+g(a.css("padding-top"))+g(a.css("border"));a=g(a.css("margin-bottom"))+g(a.css("padding-bottom"))+g(a.css("border"));return b+a}))}},z={},c=function(b){if(!(b in
z)){var a=$(b);a&&a.length&&(z[b]=a);return a}return z[b]},D=function(b,a,d,e){if("undefined"!=typeof boardContext){var g=k.header,l=k.tools,h=k.slides;b=k.keyboard;var f=k.footer;a=c("#toolsColumn");var m=c("#ribbon").find(".toolbar"),n=c(".modeSpecificTool"),p=c("#masterLayout"),q=c("#applicationMenu");c("#boardContainer");d=c("#boardColumn");e=c("#thumbsColumn");c("#slideContainer");c("#thumbScrollContainer");var t=$(".thumbnail"),u=c("#slideControls"),x=c("#masterFooter"),v=C(),r=v.width,v=v.height;
1==g?q.show():q.hide();1==l?(m.show(),n.show(),a.show()):(n.hide(),m.hide(),a.hide());Modes.currentMode==Modes.select&&Modes.select.updateAdministerContentVisualState(Conversations.getCurrentConversation());1==h?(e.show(),u.show()):(e.hide(),u.hide());1==f?x.show():x.hide();n=c("#boardContainer");g=c("#board");m=c("#masterHeader");f=m.height();DeviceConfiguration.headerHeight=f;DeviceConfiguration.footerHeight=x.height();t.attr("width",sprintf("%spx",c("#thumbColumnWidth").val()));t.attr("height",
sprintf("%spx",h?DeviceConfiguration.preferredSizes.thumbColumn.height:0));n.width();n.height();p=p.css("flex-direction");"row"==p?(l=r-(l?a.width():0)-(h?e.width():0)-w([a,e,d]).x-2,h=v-w([m,d]).y-10):(l=c("#masterLayout").width()-w([d]).x,h=l-10,b&&(h=h-l+3*(DeviceConfiguration.preferredSizes.handles+2)));if(0>h||0>l)throw{message:"retrying because of negativeValues",bheight:h,bwidth:l,width:r,height:v,marginsForBoard:w([d]),flexDirection:p};l=Math.round(l);h=Math.round(h);c("#selectionAdorner");
c("#radar");c("#marquee");c("#textAdorner");c("#imageAdorner");x.width(r-e.width()-a.width()-20).css({"margin-left":sprintf("%spx",a.width()+9)});g.width(l);g.height(h);a.height(h-f).css({"margin-top":sprintf("%spx",f+2)});e.height(h-f).css({"margin-top":sprintf("%spx",f)});d.height(h);boardContext.canvas.width=l;boardContext.canvas.height=h;boardContext.width=l;boardContext.height=h;boardWidth=l;boardHeight=h;IncludeView["default"]();blit();window.scrollTo(1,1);window.scrollTo(0,0)}},n=function(){f&&
f()},A=!1;Progress.onLayoutUpdated.DeviceConfiguration=n;Progress.historyReceived.DeviceConfiguration_showChrome=function(){try{"UserSettings"in window&&UserSettings.getIsInteractive()?(DeviceConfiguration.setSlides(!0),DeviceConfiguration.setTools(!0),!A&&"Modes"in window&&(Modes.select.activate(),"iPad"==DeviceConfiguration.getCurrentDevice()&&$("#panMode").remove())):(DeviceConfiguration.setSlides(!1),DeviceConfiguration.setTools(!1),A||Modes.none.activate()),A=!0}catch(b){console.log("Progress.historyReceived.DeviceConfiguration_showChrome",
b)}r();B();n()};$(function(){var b=$(window);if(window.orientation)b.on("orientationchange",n);b.resize(n);$("#toolsToggleButton").on("click",bounceAnd(function(){e("tools",!k.tools);var a=$("#slidesToggleButton");k.slides?a.removeClass("disabledButton"):a.addClass("disabledButton");n()}));$("#slidesToggleButton").on("click",bounceAnd(function(){e("slides",!k.slides);var a=$("#toolsToggleButton");k.tools?a.removeClass("disabledButton"):a.addClass("disabledButton");n()}));$("#thumbColumnWidth").val(DeviceConfiguration.preferredSizes.thumbColumn.width).on("input change",
function(){var a=c("#thumbColumnWidth").val();$(".thumbnail:not(.groupSlide)").width(a).height(.75*a);f();Conversations.refreshSlideDisplay()})});var B=function(){switch(m){case "browser":p();break;case "projector":void 0!=ContentFilter&&"setFilter"in ContentFilter&&ContentFilter.setFilter("myPrivate",!1);H();break;case "iPhone":p();break;case "iPad":p();break;default:p()}},t=function(){f||(f=y)},u=function(b){return function(){e(b,!k[b]);t()}},q=function(b){return function(a){e(b,a);t()}};return{getCurrentDevice:function(){return m},
setCurrentDevice:function(b){m=b;B()},applyFit:function(){t();f()},tempFit:function(b,a,c,g){e("header",b);e("tools",a);e("slides",c);e("footer",g);t();f()},setHeader:q("header"),setTools:q("tools"),setFooter:q("footer"),setSlides:q("slides"),setKeyboard:function(b){var a=!b;q("keyboard")(b);DeviceConfiguration.applyFit();$("#masterHeader").toggle(a);$(".permission-states").toggle(a);$("#majorModesColumn").toggle(a)},toggleHeader:u("header"),toggleTools:u("tools"),toggleFooter:u("footer"),toggleSlides:u("slides"),
getIdentity:function(){return E},resetCurrentDevice:function(){r();B()},hasOnScreenKeyboard:function(){return 640>=C().width||"iPad"==m},preferredSizes:{handles:50,thumbColumn:{width:100,height:75},toolsColumn:100,keyboard:{iphone:236,ipad:352}}}}();

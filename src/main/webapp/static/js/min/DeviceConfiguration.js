var DeviceConfiguration=function(){var F=Date.now(),h="browser",G=function(){var b=!1;try{b="jid"in Conversations.getCurrentConversation()}catch(a){b=!1}return"projector"!=h&&b},l={tools:!1,slides:!1,header:!1,keyboard:!1},k=function(b,a){G&&("header"==b||1!=a&&0!=a||(l[b]=a))},w=function(){h=null!=navigator.userAgent.match(/iPhone/i)||null!=navigator.userAgent.match(/iPod/i)?"iPhone":null!=navigator.userAgent.match(/iPad/i)?"iPad":null!=navigator.userAgent.match("Trident/7.0")?"IE11+":"browser"},
n=function(){w();$("#absoluteCloseButton").removeClass("closeButton").text("").click(bounceAnd(function(){}));$("#applicationMenuButton").show();d=x;try{"Conversations"in window&&"jid"in Conversations.getCurrentConversation()&&("UserSettings"in window&&UserSettings.getIsInteractive()?(DeviceConfiguration.setHeader(!0),DeviceConfiguration.setTools(!0),DeviceConfiguration.setSlides(!0)):(DeviceConfiguration.setHeader(!1),DeviceConfiguration.setTools(!1),DeviceConfiguration.setSlides(!1)))}catch(b){console.log("error while trying to fix the layout:",
b)}zoomToPage(!0);d()},I=function(){Conversations.enableSyncMove();UserSettings.setIsInteractive(!1);h="projector";k("tools",!1);k("slides",!1);k("header",!1);d=H;zoomToFit(!0);$("#absoluteCloseButton").addClass("closeButton").text("X").click(bounceAnd(function(){UserSettings.setIsInteractive(!0);n()}));$("#applicationMenuButton").hide();Modes.none.activate();d()},D=function(){var b=screen.width,a=screen.height,e;"orientation"in window?(e=window.orientation,e=90==e||-90==e):e=window.innerWidth>window.innerHeight;
"landscape"==(e?"landscape":"portrait")&&b<a&&(b=screen.height,a=screen.width);e=window.innerWidth;var c=window.innerHeight;if(!e||!c||e>b||c>a||980==e)e=window.outerWidth,c=window.outerHeight;if(!e||!c||e>b||c>a)e=screen.availWidth,c=screen.availHeight;return{width:e,height:c}},x=function(){E(l.header,l.tools,l.slides,l.keyboard)},d=x,H=function(){E(!1,!1,!1,!1)},g=function(b){b=parseInt(b.split("px")[0]);return isNaN(b)?0:b},v=function(b){return{x:_.sum(_.map(b,function(a){var b=g(a.css("margin-left"))+
g(a.css("padding-left"))+g(a.css("border"));a=g(a.css("margin-right"))+g(a.css("padding-right"))+g(a.css("border"));return b+a})),y:_.sum(_.map(b,function(a){var b=g(a.css("margin-top"))+g(a.css("padding-top"))+g(a.css("border"));a=g(a.css("margin-bottom"))+g(a.css("padding-bottom"))+g(a.css("border"));return b+a}))}},y={},c=function(b){if(!(b in y)){var a=$(b);a&&a.length&&(y[b]=a);return a}return y[b]},E=function(b,a,e,d){if("undefined"!=typeof boardContext){var g=l.header,m=l.tools,f=l.slides;
b=l.keyboard;a=c("#toolsColumn");var k=c("#ribbon").find(".toolbar"),h=c(".modeSpecificTool"),n=c("#masterLayout"),r=c("#applicationMenu");c("#boardContainer");e=c("#boardColumn");d=c("#thumbsColumn");c("#slideContainer");c("#thumbScrollContainer");var q=$(".thumbnail"),t=c("#slideControls"),u=D(),p=u.width,u=u.height;1==g?r.show():r.hide();1==m?(k.show(),h.show(),a.show()):(h.hide(),k.hide(),a.hide());1==f?(d.show(),t.show()):(d.hide(),t.hide());t=c("#boardContainer");g=c("#board");r=c("#masterHeader");
k=c("#masterFooter");h=r.height();q.attr("width",sprintf("%spx",c("#thumbColumnWidth").val()));q.attr("height",sprintf("%spx",f?DeviceConfiguration.preferredSizes.thumbColumn.height:0));t.width();t.height();n=n.css("flex-direction");"row"==n?(m=p-(m?a.width():0)-(f?d.width():0)-v([a,d,e]).x-2,f=u-v([r,e]).y-10):(m=c("#masterLayout").width()-v([e]).x,f=m-10,b&&(f=f-m+3*(DeviceConfiguration.preferredSizes.handles+2)));if(0>f||0>m)throw{message:"retrying because of negativeValues",bheight:f,bwidth:m,
width:p,height:u,marginsForBoard:v([e]),flexDirection:n};m=Math.round(m);f=Math.round(f);c("#selectionAdorner");c("#radar");c("#marquee");c("#textAdorner");c("#imageAdorner");k.width(p-d.width()-a.width()-20).css({"margin-left":sprintf("%spx",a.width()+9)});g.width(m);g.height(f);a.height(f-h).css({"margin-top":sprintf("%spx",h+2)});d.height(f-h).css({"margin-top":sprintf("%spx",h)});e.height(f);boardContext.canvas.width=m;boardContext.canvas.height=f;boardContext.width=m;boardContext.height=f;boardWidth=
m;boardHeight=f;IncludeView["default"]();blit();window.scrollTo(1,1);window.scrollTo(0,0)}},z=function(){d&&d()},A=!1;Progress.onLayoutUpdated.DeviceConfiguration=z;Progress.historyReceived.DeviceConfiguration_showChrome=function(){try{"UserSettings"in window&&UserSettings.getIsInteractive()?(DeviceConfiguration.setSlides(!0),DeviceConfiguration.setTools(!0),!A&&"Modes"in window&&(Modes.select.activate(),"iPad"==DeviceConfiguration.getCurrentDevice()&&$("#panMode").remove())):(DeviceConfiguration.setSlides(!1),
DeviceConfiguration.setTools(!1),A||Modes.none.activate()),A=!0}catch(b){console.log("Progress.historyReceived.DeviceConfiguration_showChrome",b)}w();B();d&&d()};$(function(){var b=$(window);if(window.orientation)b.on("orientationchange",z);b.resize(z);$("#toolsToggleButton").on("click",bounceAnd(function(){k("tools",!l.tools);var a=$("#slidesToggleButton");l.slides?a.removeClass("disabledButton"):a.addClass("disabledButton");d&&d()}));$("#slidesToggleButton").on("click",bounceAnd(function(){k("slides",
!l.slides);var a=$("#toolsToggleButton");l.tools?a.removeClass("disabledButton"):a.addClass("disabledButton");d&&d()}));$("#thumbColumnWidth").val(DeviceConfiguration.preferredSizes.thumbColumn.width).on("input change",function(){var a=c("#thumbColumnWidth").val();$(".thumbnail:not(.groupSlide)").width(a).height(.75*a);d();Conversations.refreshSlideDisplay()})});var B=function(){switch(h){case "browser":n();break;case "projector":void 0!=ContentFilter&&"setFilter"in ContentFilter&&ContentFilter.setFilter("myPrivate",
!1);I();break;case "iPhone":n();break;case "iPad":n();break;default:n()}},q=function(){d||(d=x)},C=function(b){return function(){k(b,!l[b]);q()}},p=function(b){return function(a){k(b,a);q()}};return{getCurrentDevice:function(){return h},setCurrentDevice:function(b){h=b;B()},applyFit:function(){q();d()},tempFit:function(b,a,c){k("header",b);k("tools",a);k("slides",c);q();d()},setHeader:p("header"),setTools:p("tools"),setSlides:p("slides"),setKeyboard:function(b){var a=!b;p("keyboard")(b);DeviceConfiguration.applyFit();
$("#masterHeader").toggle(a);$(".permission-states").toggle(a);$("#majorModesColumn").toggle(a)},toggleHeader:C("header"),toggleTools:C("tools"),toggleSlides:C("slides"),getIdentity:function(){return F},resetCurrentDevice:function(){w();B()},hasOnScreenKeyboard:function(){return 640>=D().width||"iPad"==h},preferredSizes:{handles:50,thumbColumn:{width:100,height:75},toolsColumn:100,keyboard:{iphone:236,ipad:352}}}}();

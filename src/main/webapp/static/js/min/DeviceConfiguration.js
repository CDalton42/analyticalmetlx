var DeviceConfiguration=function(){var E=Date.now(),m="browser",F=function(){var b=!1;try{b="jid"in Conversations.getCurrentConversation()}catch(a){b=!1}return"projector"!=m&&b},k={tools:!1,slides:!1,header:!1,keyboard:!1},h=function(b,a){F&&("header"==b||1!=a&&0!=a||(k[b]=a))},r=function(){m=null!=navigator.userAgent.match(/iPhone/i)||null!=navigator.userAgent.match(/iPod/i)?"iPhone":null!=navigator.userAgent.match(/iPad/i)?"iPad":null!=navigator.userAgent.match("Trident/7.0")?"IE11+":"browser"},
n=function(){r();$("#absoluteCloseButton").removeClass("closeButton").text("").click(bounceAnd(function(){}));$("#applicationMenuButton").show();d=w;try{"Conversations"in window&&"jid"in Conversations.getCurrentConversation()&&("UserSettings"in window&&UserSettings.getIsInteractive()?(DeviceConfiguration.setHeader(!0),DeviceConfiguration.setTools(!0),DeviceConfiguration.setSlides(!0)):(DeviceConfiguration.setHeader(!1),DeviceConfiguration.setTools(!1),DeviceConfiguration.setSlides(!1)))}catch(b){console.log("error while trying to fix the layout:",
b)}zoomToPage(!0);d()},H=function(){Conversations.enableSyncMove();UserSettings.setIsInteractive(!1);m="projector";h("tools",!1);h("slides",!1);h("header",!1);d=G;zoomToFit(!0);$("#absoluteCloseButton").addClass("closeButton").text("X").click(bounceAnd(function(){UserSettings.setIsInteractive(!0);n()}));$("#applicationMenuButton").hide();Modes.none.activate();d()},C=function(){var b=screen.width,a=screen.height,e;"orientation"in window?(e=window.orientation,e=90==e||-90==e):e=window.innerWidth>window.innerHeight;
"landscape"==(e?"landscape":"portrait")&&b<a&&(b=screen.height,a=screen.width);e=window.innerWidth;var c=window.innerHeight;if(!e||!c||e>b||c>a||980==e)e=window.outerWidth,c=window.outerHeight;if(!e||!c||e>b||c>a)e=screen.availWidth,c=screen.availHeight;return{width:e,height:c}},w=function(){D(k.header,k.tools,k.slides,k.keyboard)},d=w,G=function(){D(!1,!1,!1,!1)},g=function(b){b=parseInt(b.split("px")[0]);return isNaN(b)?0:b},v=function(b){return{x:_.sum(_.map(b,function(a){var b=g(a.css("margin-left"))+
g(a.css("padding-left"))+g(a.css("border"));a=g(a.css("margin-right"))+g(a.css("padding-right"))+g(a.css("border"));return b+a})),y:_.sum(_.map(b,function(a){var b=g(a.css("margin-top"))+g(a.css("padding-top"))+g(a.css("border"));a=g(a.css("margin-bottom"))+g(a.css("padding-bottom"))+g(a.css("border"));return b+a}))}},x={},c=function(b){if(!(b in x)){var a=$(b);a&&a.length&&(x[b]=a);return a}return x[b]},D=function(b,a,e,d){if("undefined"!=typeof boardContext){var g=k.header,l=k.tools,f=k.slides;
b=k.keyboard;a=c("#toolsColumn");var h=c("#ribbon").find(".toolbar"),m=c(".modeSpecificTool"),n=c("#masterLayout"),t=c("#applicationMenu");c("#boardContainer");e=c("#boardColumn");d=c("#thumbsColumn");c("#slideContainer");c("#thumbScrollContainer");var p=$(".thumbnail"),q=c("#slideControls"),u=C(),r=u.width,u=u.height;1==g?t.show():t.hide();1==l?(h.show(),m.show(),a.show()):(m.hide(),h.hide(),a.hide());1==f?(d.show(),q.show()):(d.hide(),q.hide());t=c("#boardContainer");g=c("#board");h=c("#masterHeader");
m=c("#masterFooter");p.attr("width",sprintf("%spx",c("#thumbColumnWidth").val()));p.attr("height",sprintf("%spx",f?DeviceConfiguration.preferredSizes.thumbColumn.height:0));t.width();t.height();n=n.css("flex-direction");"row"==n?(l=r-(l?a.width():0)-(f?d.width():0)-v([a,d,e]).x-2,f=u-h.height()-v([h,e]).y-10-m.height()):(l=c("#masterLayout").width()-v([e]).x,f=l-10,b&&(f=f-l+3*(DeviceConfiguration.preferredSizes.handles+2)));if(0>f||0>l)throw{message:"retrying because of negativeValues",bheight:f,
bwidth:l,width:r,height:u,marginsForBoard:v([e]),flexDirection:n};l=Math.round(l);f=Math.round(f);c("#selectionAdorner");c("#radar");c("#marquee");c("#textAdorner");c("#imageAdorner");g.width(l);g.height(f);a.height(f);d.height(f);e.height(f);boardContext.canvas.width=l;boardContext.canvas.height=f;boardContext.width=l;boardContext.height=f;boardWidth=l;boardHeight=f;IncludeView["default"]();blit();window.scrollTo(1,1);window.scrollTo(0,0)}},y=function(){d&&d()},z=!1;Progress.onLayoutUpdated.DeviceConfiguration=
y;Progress.historyReceived.DeviceConfiguration_showChrome=function(){try{"UserSettings"in window&&UserSettings.getIsInteractive()?(DeviceConfiguration.setSlides(!0),DeviceConfiguration.setTools(!0),!z&&"Modes"in window&&(Modes.draw.activate(),"iPad"==DeviceConfiguration.getCurrentDevice()&&$("#panMode").remove())):(DeviceConfiguration.setSlides(!1),DeviceConfiguration.setTools(!1),z||Modes.none.activate()),z=!0}catch(b){console.log("Progress.historyReceived.DeviceConfiguration_showChrome",b)}r();
A();d&&d()};$(function(){var b=$(window);if(window.orientation)b.on("orientationchange",y);b.resize(y);$("#toolsToggleButton").on("click",bounceAnd(function(){h("tools",!k.tools);var a=$("#slidesToggleButton");k.slides?a.removeClass("disabledButton"):a.addClass("disabledButton");d&&d()}));$("#slidesToggleButton").on("click",bounceAnd(function(){h("slides",!k.slides);var a=$("#toolsToggleButton");k.tools?a.removeClass("disabledButton"):a.addClass("disabledButton");d&&d()}));$("#thumbColumnWidth").val(DeviceConfiguration.preferredSizes.thumbColumn.width).on("input change",
function(){var a=c("#thumbColumnWidth").val();$(".thumbnail:not(.groupSlide)").height(.75*a);d()})});var A=function(){switch(m){case "browser":n();break;case "projector":void 0!=ContentFilter&&"setFilter"in ContentFilter&&ContentFilter.setFilter("myPrivate",!1);H();break;case "iPhone":n();break;case "iPad":n();break;default:n()}},p=function(){d||(d=w)},B=function(b){return function(){h(b,!k[b]);p()}},q=function(b){return function(a){h(b,a);p()}};return{getCurrentDevice:function(){return m},setCurrentDevice:function(b){m=
b;A()},applyFit:function(){p();d()},tempFit:function(b,a,c){h("header",b);h("tools",a);h("slides",c);p();d()},setHeader:q("header"),setTools:q("tools"),setSlides:q("slides"),setKeyboard:function(b){var a=!b;q("keyboard")(b);DeviceConfiguration.applyFit();$("#masterHeader").toggle(a);$(".permission-states").toggle(a);$("#majorModesColumn").toggle(a)},toggleHeader:B("header"),toggleTools:B("tools"),toggleSlides:B("slides"),getIdentity:function(){return E},resetCurrentDevice:function(){r();A()},hasOnScreenKeyboard:function(){return 640>=
C().width||"iPad"==m},preferredSizes:{handles:50,thumbColumn:{width:100,height:75},toolsColumn:100,keyboard:{iphone:236,ipad:352}}}}();
